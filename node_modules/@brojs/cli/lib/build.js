import webpack from 'webpack';
import webpackConfig  from  '@brojs/webpack-config';
import { getModuleData } from   '@brojs/utils';

export const build = async ({ prod }) => {
  process.env.NODE_ENV = prod ? 'production' : 'development';
  const moduleData = await getModuleData();
  process.env.ENTRY = moduleData.entryPoint;
  
  webpack(await webpackConfig(), (err, stats) => {
      if (err) {
        throw error;
      }

      console.log(stats.toString({
        chunks: false,  // Makes the build much quieter
        colors: true    // Shows colors in the console
      }));
  });
}

import path from 'path';
import hbs from 'hbs';

import registerPartialsWithExtensions from './utils/registerPartialsWithExtensions.js';

function toJSON (obj) {
    if (typeof obj === 'object') {
        return JSON.stringify(obj, null, 4)
    }
    return obj
}

export const applyHbs = (app) => {
    const templates = path.resolve('node_modules', '@brojs/templates', 'src/templates')
    registerPartialsWithExtensions(hbs, templates)
    hbs.registerHelper('toJSON', toJSON)
    app.engine('hbs', hbs.__express)
    app.set('views', templates)
}

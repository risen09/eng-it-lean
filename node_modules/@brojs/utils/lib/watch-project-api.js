import chalk from 'chalk';
import watch from 'recursive-watch';

import {safeConnectApi} from './safe-connect-api.js';

let watchId = null;

export const watchProjectApi = (app, location) => {
    const watchApi = () => {
        clearTimeout(watchId);
        watchId = setTimeout(() => {
            safeConnectApi(app, location);
            console.log(chalk.green('api updated'));
        }, 200);
    }

    safeConnectApi(app, location);
    watch(location, watchApi);
}
